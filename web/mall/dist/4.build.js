webpackJsonp([4,12],{157:function(t,n,e){var s,i;e(158),s=e(!function(){var t=new Error('Cannot find module "-!babel-loader!../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./detail.vue"');throw t.code="MODULE_NOT_FOUND",t}()),i=e(161),t.exports=s||{},t.exports.__esModule&&(t.exports=t.exports["default"]),i&&(("function"==typeof t.exports?t.exports.options:t.exports).template=i)},158:function(t,n,e){var s=e(159);"string"==typeof s&&(s=[[t.id,s,""]]);e(104)(s,{});s.locals&&(t.exports=s.locals)},159:function(t,n,e){n=t.exports=e(103)(),n.push([t.id,"\n    .tabbar-wrap .wq-img{\n        width:20px; margin-right:10px;\n    }\n    .tabbar-wrap .weui_cell_ft.with_arrow {\n        margin-right:0 !important;\n    }\n    .tabbar-wrap .weui_cell_ft.with_arrow:after{\n        right:0 !important;\n    }\n","",{version:3,sources:["/./src/views/product/detail.vue.style"],names:[],mappings:";IAkPA;QACA,WAAA,CAAA,kBAAA;KACA;IACA;QACA,0BAAA;KACA;IACA;QACA,mBAAA;KACA",file:"detail.vue",sourcesContent:['<template>\n<div class="tabbar-wrap">\n    <!-- banner -->\n    <c-top-back :mar=\'true\'></c-top-back>\n    <c-messages v-if="product_no" :status="2" msg="商品不存在或已删除">\n        <div slot="btn">\n          <c-button type="primary" text="返回首页" @click.native="btnClick"></c-button>\n        </div>\n    </c-messages>\n    <div v-else>\n        <div v-if="dataReady">\n            <c-product-wrap type="normal">\n              <c-product :title="goods.name" :des="goods.logistics_fee | formatPriceCNY" :price="goods.price" :pic="goods.pics"></c-product>\n            </c-product-wrap>\n            <c-cell-wrap>\n                <c-cell :title="storeInfo.name" value="进入店铺" is-link @click.native="link_home">\n                    <img class="wq-img" slot="icon" src=\'http://static.taggole.com/sithbrobot/poster/1489997146660.jpg\'/>\n                </c-cell>\n            </c-cell-wrap>\n\n            <c-title title="商品详情"></c-title>\n            <div class="wrap-detail">\n                <p>{{goods.product_detail}}</p>\n                <p v-for=\'i in goods.product_desc\'><img v-bind:src="i" alt="" style="width:100%; height:auto;"></p>\n            </div>\n\n            <c-sku v-model="sku.status" :title="goods.name" :img="goods.pics" :price="goods.price" :text="sku.buttonTxt" :sku=\'skuList\' @submit="submit"></c-sku>\n            <c-button text="立即购买" size="block" @click.native="barClick" type="primary" style="position:fixed; bottom:0"></c-button>\n        </div>\n    </div>\n        \n</div>\n\n</template>\n<script>\n    import utils from \'../../libs/utils.js\';\n    import constants from \'../../libs/constants.js\';\n    export default {\n        data (){\n            return {\n                dataReady:false,\n                goods:{},//商品信息\n                skuList:[],//商品sku列表\n                skuList1:[]\n                storeInfo:{name:\'测试\'},//店铺信息\n                content:{},//商品详细信息\n                goods_id:0,//商品id\n                sku:{\n                    status:false,\n                    url:basepath + "/mall/store/shelf_product_sku_get",\n                    buttonTxt:"下一步",\n                },\n                submitType:"buy",\n                hasCart:true,//是否显示购物车\n                limitNum:\'\',\n                rule_flag:\'\',\n                pageId:\'\',\n                invoiceTypes:[],\n                logistic_flg:1,\n                product_no:false\n            }\n        },\n        mounted: function () {\n            this.$nextTick(function () {\n                //utils.MenuShare();    \n                let that = this;\n                utils.ajax({\n                    url: basepath + "/user/product/get",\n                    async:false,\n                    data:{"id":that.$route.query.product_id},\n                    success: function(data){\n                        if(data.code==\'SUCESS\'){\n                            that.goods=data.result;\n                            that.goods.logistics_fee=that.goods.logistics_fee;\n                            that.goods.product_desc=JSON.parse(that.goods.product_desc);\n                            utils.ajax({\n                                url: basepath + "/user/product/sku/get",\n                                async:false,\n                                data:{"product_id":data.result.id},\n                                success: function(res){\n                                    if(res.code==\'SUCESS\'){\n                                        var max=res.result[0].price;\n                                        var min=res.result[0].price;\n                                        var len=res.result.length;\n\n                                        for(var ii=1; ii<len; ii++){\n                                          if(res.result[ii].price > max){\n                                            max = res.result[ii].price;\n                                          }\n                                        }\n\n                                        for(var i=1; i<len; i++){\n                                          if(res.result[i].price < min){\n                                            min = res.result[i].price;\n                                          }\n                                        }\n                                        if(min!=max){\n                                            that.goods.price=\'¥\'+utils.formatPrice(min)+\' ~ ¥\'+utils.formatPrice(max);\n                                        }else{\n                                            that.goods.price=\'¥\'+utils.formatPrice(min);\n                                        }\n                                        that.skuList1=res.result;\n                                        $.each(res.result,function(i,v){\n                                            that.skuList.push({\n                                                id:v.id,\n                                                name:v.sku_str,\n                                                price:utils.formatPrice(v.price),\n                                                stock:v.stock\n                                            })\n                                        })\n                                    }else{\n                                        that.$vux.alert.show(res.message);\n                                    }\n                                }\n                                \n                            });\n\n                            that.dataReady = true;\n                        }else if(data.code==\'1111\'){\n                            that.product_no=true;\n                        }else{\n                            that.$vux.alert.show(data.message);\n                        }\n                    }\n                    \n                    \n                });\n\n                utils.ajax({\n                  url: "/mall/wxconfig/get",\n                  data:{\'base_url\':window.location.href.split(\'#\')[0]},\n                  success: function(data) {\n                    if(data.code==\'SUCESS\') {\n                      wx.config({\n                          debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\n                          appId: data.obj.appId, // 必填，公众号的唯一标识\n                          timestamp: data.obj.timestamp, // 必填，生成签名的时间戳\n                          nonceStr: data.obj.nonceStr, // 必填，生成签名的随机串\n                          signature: data.obj.signature,// 必填，签名，见附录1\n                          jsApiList: [\'onMenuShareAppMessage\',\'onMenuShareTimeline\'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2\n                      });\n                      wx.ready(function(){\n                        wx.onMenuShareAppMessage({\n                            title: that.goods.title, // 分享标题\n                            desc: \'【\'+that.storeInfo.name+\'】发现好商品，立即分享给你，进店有惊喜呦。\', // 分享描述\n                            link: window.location.href, // 分享链接\n                            imgUrl: that.goods.pic // 分享图标\n                        });\n\n                        wx.onMenuShareTimeline({\n                            title: that.goods.title, // 分享标题\n                            link: window.location.href, // 分享链接\n                            imgUrl: that.goods.pic // 分享图标\n                        });\n                      })\n                    } else {\n                      that.$vux.alert.show(data.message);\n                    }\n                  },\n                });\n\n                if(utils.getSession(\'pageId\')){\n                    that.pageId=utils.getSession(\'pageId\');\n                }else{\n                    utils.ajax({\n                        url: basepath + "/mall/store/get",\n                        dataType: \'json\',\n                        type: \'POST\',\n                        success: function(data){\n                            if(data.success){\n                                that.pageId=data.obj.page_id;\n                            }\n                        }\n                    });\n                }\n            })\n        },\n        methods:{\n            submit(submitData){\n                if(this.submitType == "buy"){\n                    var buy_info_price = null;\n                    $.each(this.skuList1,function(i,v){\n                        if(v.id==submitData.sku.id){\n                            buy_info_price = v.price;\n                        }\n                    })\n                    \n                    var buy_info = {\n                        "products":[\n                            {\n                                "id":submitData.sku.id,\n                                "name": this.goods.name,//商品名称\n                                "pic": this.goods.pics,//商品图片\n                                "properties": submitData.sku.name,//规格信息\n                                "price": buy_info_price,//货架商品价格\n                                "num": submitData.num,//购买商品的数量\n                            }\n                        ],\n                        \'logistics_fee\':this.goods.logistics_fee,\n                        \'discount\':0,\n                        \'logistic_flg\':1\n                    };\n                    utils.setSession("buy_info",buy_info);\n                    utils.go({path:"/order/add"},this.$router);\n                }else{\n                    this.sku.status = false;\n                    this.$vux.toast.show({\n                        text:"操作成功",\n                        type:"success"\n                    });\n                }\n\n\n            },\n            barClick(type){\n                this.sku.status = true;\n                this.submitType = "buy";\n            },\n            link_home(){\n                utils.go({path:\'/home/home\',query:{id:this.$route.query.store_id}},this.$router,true);\n            },\n            btnClick(){\n                utils.go({path:\'/home/home\',query:{id:this.$route.query.store_id}},this.$router,true);\n            }\n            \n        },\n        components:{\n            "cProduct": require(\'../../components/x-product/x-product.vue\'),\n            "cProductWrap": require(\'../../components/x-product/x-product-wrap.vue\'),\n            "cTopBack":require(\'../../components/x-top-back/x-top-back.vue\'),\n            "cCellWrap":require(\'../../components/cell/cell-wrap.vue\'),\n            "cCell":require(\'../../components/cell/cell.vue\'),\n            "cButton":require(\'../../components/button/button.vue\'),\n            "cTitle":require(\'../../components/x-title/x-title.vue\'),\n            "cPayBar1":require(\'../../components/x-pay-bar/x-pay-bar1.vue\'),\n            "cPayBar1":require(\'../../components/x-pay-bar/x-pay-bar2.vue\'),\n            "cSku":require(\'../../components/x-sku/x-sku.vue\'),\n            "cMessages": require(\'../../components/x-messages/x-messages.vue\'),\n        }\n    }\n</script>\n<style>\n    .tabbar-wrap .wq-img{\n        width:20px; margin-right:10px;\n    }\n    .tabbar-wrap .weui_cell_ft.with_arrow {\n        margin-right:0 !important;\n    }\n    .tabbar-wrap .weui_cell_ft.with_arrow:after{\n        right:0 !important;\n    }\n</style>\n'],sourceRoot:"webpack://"}])},161:function(t,n){t.exports='\n<div class="tabbar-wrap">\n    <!-- banner -->\n    <c-top-back :mar=\'true\'></c-top-back>\n    <c-messages v-if="product_no" :status="2" msg="商品不存在或已删除">\n        <div slot="btn">\n          <c-button type="primary" text="返回首页" @click.native="btnClick"></c-button>\n        </div>\n    </c-messages>\n    <div v-else>\n        <div v-if="dataReady">\n            <c-product-wrap type="normal">\n              <c-product :title="goods.name" :des="goods.logistics_fee | formatPriceCNY" :price="goods.price" :pic="goods.pics"></c-product>\n            </c-product-wrap>\n            <c-cell-wrap>\n                <c-cell :title="storeInfo.name" value="进入店铺" is-link @click.native="link_home">\n                    <img class="wq-img" slot="icon" src=\'http://static.taggole.com/sithbrobot/poster/1489997146660.jpg\'/>\n                </c-cell>\n            </c-cell-wrap>\n\n            <c-title title="商品详情"></c-title>\n            <div class="wrap-detail">\n                <p>{{goods.product_detail}}</p>\n                <p v-for=\'i in goods.product_desc\'><img v-bind:src="i" alt="" style="width:100%; height:auto;"></p>\n            </div>\n\n            <c-sku v-model="sku.status" :title="goods.name" :img="goods.pics" :price="goods.price" :text="sku.buttonTxt" :sku=\'skuList\' @submit="submit"></c-sku>\n            <c-button text="立即购买" size="block" @click.native="barClick" type="primary" style="position:fixed; bottom:0"></c-button>\n        </div>\n    </div>\n        \n</div>\n\n'}});