webpackJsonp([6,12],{147:function(e,n,t){var r,a;t(148),r=t(!function(){var e=new Error('Cannot find module "-!babel-loader!../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./add.vue"');throw e.code="MODULE_NOT_FOUND",e}()),a=t(151),e.exports=r||{},e.exports.__esModule&&(e.exports=e.exports["default"]),a&&(("function"==typeof e.exports?e.exports.options:e.exports).template=a)},148:function(e,n,t){var r=t(149);"string"==typeof r&&(r=[[e.id,r,""]]);t(86)(r,{});r.locals&&(e.exports=r.locals)},149:function(e,n,t){n=e.exports=t(85)(),n.push([e.id,"\n    .order_add .weui_cell_ft.with_arrow{\n        margin-right:0 !important; \n    }\n    .order_add .weui_cell_ft.with_arrow:after{\n        right:0 !important;\n    }\n    .order_add .weui_panel:first-child{\n        margin-top:10px !important;\n    }\n","",{version:3,sources:["/./src/views/order/add.vue.style"],names:[],mappings:";IA2JA;QACA,0BAAA;KACA;IACA;QACA,mBAAA;KACA;IACA;QACA,2BAAA;KACA",file:"add.vue",sourcesContent:['<template>\n    <div class="order_add">\n        <c-top-back></c-top-back>\n        <c-group v-if="!addressStatus">\n            <c-cell title="+ 添加收货地址" @click.native="addarr" is-link></c-cell>\n        </c-group>\n        <c-group v-else>\n            <c-address-info :id="addressData.id" :name="addressData.name" :phone="addressData.phone" :arrows="true"\n                            :address="addressData.str" @click="modarr"></c-address-info>\n        </c-group>\n        <!--商品列表-->\n        <div>\n            <c-panel-img listname="商品列表">\n                <c-panel-list v-for=\'item in json.products\'\n                              :id=\'item.id\'\n                              :others=\'item.num\'\n                              :title=\'item.name\'\n                              :details=\'item.properties?"规格："+item.properties:"规格：无"\'\n                              :from=\'item.price | formatPrice\'\n                              :imglink="item.pic+\'?imageMogr2/thumbnail/60x\'"\n                              :colororg=\'true\'\n                              :cheng="true">\n                </c-panel-list>\n            </c-panel-img>\n        </div>\n        <c-group>\n            <c-cell title="优惠" :value="json.discount | formatPriceCNY"></c-cell>\n            <c-cell title="运费" :value="json.logistics_fee | formatPriceCNY"></c-cell>\n        </c-group>\n        <c-pay-bar2 :disabled="disabled" :type="color" :price="(totalMoney*1)+(json.logistics_fee*1) | formatPrice" @on-button="addOrder" buytext="提交订单"></c-pay-bar2>\n    </div>\n\n\n</template>\n<script>\n    import utils from \'../../libs/utils.js\';\n    import constants from \'../../libs/constants.js\';\n    export default {\n        data (){\n            return {\n                //初始化数据\n                json: {},\n                //可选支付列表\n                payList: [],\n                ticket: {id: "", name: ""},\n                noTicketName: "",//不支持开发票的货架商品\n                totalMoney: "",//总金额\n                addr_id:\'\',\n                order_id:\'\',\n                addressData:{},\n                addressStatus:false,\n                disabled:true,\n                color:\'default\',\n                arr:[]\n            }\n        },\n        mounted: function () {\n            this.$nextTick(function () {\n                //utils.MenuShare();\n\n                this.json = JSON.parse(utils.getSession("buy_info"));//商品数据列表\n                let that = this;\n                $.each(this.json.products,function(i,v){\n                    that.totalMoney+=v.price*v.num;\n                    that.arr.push({\n                        sku_id:v.id,\n                        price:v.price,\n                        count:v.num\n                    })\n                })\n\n                utils.ajax({\n                    url: basepath + "/user/user/address/default", success: function (data) {\n                        if (data.code=="SUCESS") {\n                            if(data.result){\n                                that.addressData=data.result;\n                                that.addressStatus=true;\n                                that.disabled=false;\n                                that.color=\'primary\';\n                                that.addr_id=data.result.id;\n                            }\n                        }else if(data.code!="SUCESS" && data.code!="xvp_user1008"){\n                            that.$vux.alert.show(data.message);\n                        }else if(data.code==\'user_seller_error\'){\n                            that.$vux.alert.show({content:\'访问超时\',onHide :function(){\n                              utils.go({path:\'/login/login\',query:{id:sessionStorage.getItem(\'product_id\')},that.$router);\n                            }});\n                        }\n                    }\n                });\n                utils.MenuShare();\n            })\n        },\n        methods: {\n            //提交订单\n            addOrder(){\n                if (utils.getSession("buy_info")) {\n                    let that = this;\n\n\n                    let obj = {\n                        logistic_flg:that.json.logistic_flg,\n                        logistic_fee:that.json.logistics_fee*1,\n                        pay_amount:that.totalMoney,\n                        addressee_id:that.addr_id,\n                        buy_sku_list:that.arr\n                    }\n                    utils.ajax({\n                        url: basepath + "/user/order/add", data: obj, success: function (data) {\t\n                            if (data.code=="SUCESS") {\n                                var backUrl = basepath + "/mall/index.html#/order/detail?id=" + data.result.order_id;\n                                window.history.replaceState(null, "订单详情页", backUrl);\n                                utils.ajax({\n                                    url: basepath + "/user/order/payurl", data: {order_id:data.result.order_id}, success: function (res) {\n                                        if (res.code=="SUCESS") {\n                                            location.href=res.result.url;\n                                        }else{\n                                            that.$vux.alert.show(res.message);\n                                        }\n                                    }\n                                });\n                            }else if(data.code==\'user_seller_error\'){\n                                that.$vux.alert.show({content:\'访问超时\',onHide :function(){\n                                  utils.go({path:\'/login/login\',query:{id:sessionStorage.getItem(\'product_id\')},that.$router);\n                                }});\n                            }else{\n                                that.$vux.alert.show(data.message);\n                            }\n                        }\n                    });\n                } else {\n                    this.$vux.alert.show(\'请重新选择商品\');\n                }\n\n            },\n            modarr(){\n                utils.go({path:\'/addr/mod\',query:{\'id\':this.addressData.id}},this.$router,true);\n            },\n            addarr(){\n                utils.go({path:\'/addr/add\'},this.$router,true);\n            }\n\n        },\n        components: {\n            "cTopBack": require(\'../../components/x-top-back/x-top-back.vue\'),\n            "cGroup": require(\'../../components/group/group.vue\'),\n            "cCell": require(\'../../components/cell/cell.vue\'),\n            "cPanelImg": require(\'../../components/x-panel-list/x-panel-img.vue\'),\n            "cPanelList": require(\'../../components/x-panel-list/x-panel-list.vue\'),\n            "cPayBar2": require(\'../../components/x-pay-bar/x-pay-bar2.vue\'),\n            "cAddressInfo": require(\'../../components/x-address-info/x-address-info.vue\'),\n        }\n    }\n</script>\n<style>\n    .order_add .weui_cell_ft.with_arrow{\n        margin-right:0 !important; \n    }\n    .order_add .weui_cell_ft.with_arrow:after{\n        right:0 !important;\n    }\n    .order_add .weui_panel:first-child{\n        margin-top:10px !important;\n    }\n</style>\n'],sourceRoot:"webpack://"}])},151:function(e,n){e.exports='\n    <div class="order_add">\n        <c-top-back></c-top-back>\n        <c-group v-if="!addressStatus">\n            <c-cell title="+ 添加收货地址" @click.native="addarr" is-link></c-cell>\n        </c-group>\n        <c-group v-else>\n            <c-address-info :id="addressData.id" :name="addressData.name" :phone="addressData.phone" :arrows="true"\n                            :address="addressData.str" @click="modarr"></c-address-info>\n        </c-group>\n        <!--商品列表-->\n        <div>\n            <c-panel-img listname="商品列表">\n                <c-panel-list v-for=\'item in json.products\'\n                              :id=\'item.id\'\n                              :others=\'item.num\'\n                              :title=\'item.name\'\n                              :details=\'item.properties?"规格："+item.properties:"规格：无"\'\n                              :from=\'item.price | formatPrice\'\n                              :imglink="item.pic+\'?imageMogr2/thumbnail/60x\'"\n                              :colororg=\'true\'\n                              :cheng="true">\n                </c-panel-list>\n            </c-panel-img>\n        </div>\n        <c-group>\n            <c-cell title="优惠" :value="json.discount | formatPriceCNY"></c-cell>\n            <c-cell title="运费" :value="json.logistics_fee | formatPriceCNY"></c-cell>\n        </c-group>\n        <c-pay-bar2 :disabled="disabled" :type="color" :price="(totalMoney*1)+(json.logistics_fee*1) | formatPrice" @on-button="addOrder" buytext="提交订单"></c-pay-bar2>\n    </div>\n\n\n'}});